# PISA Math Score Prediction

This repository contains a solution for the Hi! Paris AI & Data Science Hackathon. The goal is to predict students' PISA Math Scores (`MathScore`) based on a variety of cognitive, behavioral, and socio-economic features.

## Project Structure

- **`Prediction_Model.ipynb`**: The main pipeline for training and prediction. It implements a two-stage approach:
  1.  **Classification**: Determines if a student has a non-zero math score (using an ensemble of LightGBM and XGBoost).
  2.  **Regression**: Predicts the exact score for students identified as having a score > 0 (using weighted LightGBM and XGBoost regressors).
- **`Dataset discovery and Feature extraction.ipynb`**: Exploratory Data Analysis (EDA) notebook used to understand dataset structure, missing values, and feature correlations.

## Methodology

### 1. Feature Engineering
We engineered several custom features to capture student behavior and background:
- **Psychometrics**: Indicators for math anxiety (`MATHEASE`), confidence (`ST290`), and teacher feedback.
- **Timing & Effort**: Total time spent on science/reading modules, number of items attempted, and standard deviation of response times.
- **Student Persona**: K-Means clustering (7 clusters) based on global timing and attempt patterns.
- **Wealth Index**: aggregated from possession data (`ST25` columns).
- **Target Encoding**: Smoothed target encoding applied to `CNTSCHID` (School ID) and `student_persona`.

### 2. Modeling Strategy
Due to the large number of zero-scores (students who did not attempt the math section), we split the problem:
- **Stage 1 (Binary Classification)**:
  - Predicts $P(MathScore > 0)$.
  - Ensemble: `w * LightGBM + (1-w) * XGBoost`.
  - Threshold optimization was performed to maximize F1-score.
- **Stage 2 (Regression)**:
  - Predicts the scalar `MathScore` for positive cases.
  - Ensemble: `0.2 * LightGBM + 0.8 * XGBoost`.

### 3. Training
- The model is trained separately for each year (2015, 2018, 2022) to account for temporal drift in the PISA test structure.
- **Result**: The final output is generated by masking the regression predictions with the classification outcome.


